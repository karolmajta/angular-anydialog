angular.module("karolmajta.anydialog",[]).directive("modal",["$exceptionHandler","$controller","$q","$templateCache","$parse","$http","$compile","$injector",function(a,b,c,d,e,f,g,h){return{restrict:"EA",link:function(i,j,k){if(!k.name)return void a("modal could not be bound.","`name` attribute was not set, or set to falsy value.`name` attribute is required to bind model to controller scope");if(!k.adapter)return void a("modal could not be bound.","`adapter` attribute was not set, or set to falsy value.`adapter` attribute is required to inject proper UI adapter.");if(!k.adapter)return void a("modal could not be bound.","`templateUrl` was not set");var l=k.name,m=h.get(k.adapter),n=!1,o=i,p=k.controlledBy?k.controlledBy:null,q=e(k.templateUrl),r=function(a,e){var h=!1,i=q(o),k=this,r=a;e||(e={});for(var s in e)e.hasOwnProperty(s)&&(r[s]=e[s]);p&&b(p,{$scope:r});var t=c.defer();void 0!==d.get(i)?t.resolve(d.get(i)):f.get(i).then(function(a){var b=a.data;d.put(i,b),t.resolve(b)},function(){t.resolve("")});var u=c.defer();t.promise.then(function(b){var c=g(b),d=c(a);u.resolve(d)});var v=c.defer();u.promise.then(function(a){j.empty(),j.append(a),m.show(k,l,a).finally(function(){v.resolve(k)}),n=!0});var w=c.defer();return this.hide=function(a){var b=c.defer();return h||(h=!0,m.hide(k,l,$(j).children()).then(function(c){w.resolve(a),b.resolve(c)},function(c){w.resolve(a),b.reject(c)}).finally(function(){r.$destroy(),j.empty(),n=!1})),b.promise},v.promise.result=w.promise,v.promise},s=function(b){if(n)return a("Modal `"+l+"` already shown","Please call #hide first"),c.when(null);var d=i.$new(!0),e=new r(d,b);return e.then(function(a){d.$modal=a}),e};o["$"+l]={show:s}}}}]);